var prevAddedItem = "", selectedMedList = new Array, selectedMedObjList = new Array; function getArrow(t, e) { switch (t) { case "<up>": return $("<div>").append($("<span>").attr("id", "upArrow").append($("<svg>").attr("xmlns", "http://www.w3.org/2000/svg").attr("width", "16").attr("height", "16").attr("fill", "currentColor").attr("class", "bi bi-arrow-up").attr("viewBox", "0 0 16 16").append($("<path>").attr("fill-rule", "evenodd").attr("d", "M8 15a.5.5 0 0 0 .5-.5V2.707l3.146 3.147a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 1 0 .708.708L7.5 2.707V14.5a.5.5 0 0 0 .5.5z"))), $("<span>").text(e)); case "<down>": return $("<div>").append($("<span>").attr("id", "downArrow").append($("<svg>").attr("xmlns", "http://www.w3.org/2000/svg").attr("width", "16").attr("height", "16").attr("fill", "currentColor").attr("class", "bi bi-arrow-down").attr("viewBox", "0 0 16 16").append($("<path>").attr("fill-rule", "evenodd").attr("d", "M8 1a.5.5 0 0 1 .5.5v11.793l3.146-3.147a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 .708-.708L7.5 13.293V1.5A.5.5 0 0 1 8 1z"))), $("<span>").text(e)); case "<up><down>": return $("<div>").append($("<span>").attr("id", "updownArrow").append($("<svg>").attr("xmlns", "http://www.w3.org/2000/svg").attr("width", "16").attr("height", "16").attr("fill", "currentColor").attr("class", "bi bi-arrow-down-up").attr("viewBox", "0 0 16 16").append($("<path>").attr("fill-rule", "evenodd").attr("d", "M11.5 15a.5.5 0 0 0 .5-.5V2.707l3.146 3.147a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 1 0 .708.708L11 2.707V14.5a.5.5 0 0 0 .5.5zm-7-14a.5.5 0 0 1 .5.5v11.793l3.146-3.147a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 .708-.708L4 13.293V1.5a.5.5 0 0 1 .5-.5z"))), $("<span>").text(e)); case "<double-arrow>": return $("<div>").append($("<span>").attr("id", "doubleArrow").append($("<svg>").attr("xmlns", "http://www.w3.org/2000/svg").attr("width", "16").attr("height", "16").attr("fill", "currentColor").attr("class", "bi bi-arrow-left-right").attr("viewBox", "0 0 16 16").append($("<path>").attr("fill-rule", "evenodd").attr("d", "M1 11.5a.5.5 0 0 0 .5.5h11.793l-3.147 3.146a.5.5 0 0 0 .708.708l4-4a.5.5 0 0 0 0-.708l-4-4a.5.5 0 0 0-.708.708L13.293 11H1.5a.5.5 0 0 0-.5.5zm14-7a.5.5 0 0 1-.5.5H2.707l3.147 3.146a.5.5 0 1 1-.708.708l-4-4a.5.5 0 0 1 0-.708l4-4a.5.5 0 1 1 .708.708L2.707 4H14.5a.5.5 0 0 1 .5.5z"))), $("<span>").text(e)) } } function getInteractionIcon(t) { switch (t) { case "contra-indicated": return $("<span>").attr("id", "ci").append($("<svg>").attr("xmlns", "http://www.w3.org/2000/svg").attr("width", "48").attr("height", "48").attr("fill", "none").attr("viewBox", "0 0 48 48").append($("<path>").attr("d", "M30 25.1409V12.5C30 11.6716 29.3285 11 28.5 11C27.6716 11 27 11.6716 27 12.5V23H25V9.5C25 8.67157 24.3285 8 23.5 8C22.6716 8 22 8.67157 22 9.5V23H20V12.5C20 11.6716 19.3285 11 18.5 11C17.6716 11 17 11.6716 17 12.5V25H15V16.5C15 15.6716 14.3285 15 13.5 15C12.6716 15 12 15.6716 12 16.5V29.7375C12 35.4053 16.5947 40 22.2625 40C26.0571 40 29.542 37.9061 31.3236 34.5557L37.2298 23.4485C37.667 22.6263 37.4098 21.6065 36.635 21.09C35.7542 20.5028 34.5598 20.7924 34.0458 21.7177L31.8742 25.6265C31.3731 26.5285 30 26.1727 30 25.1409Z").attr("fill", "#8B0E04"), $("<path>").attr("fill-rule", "evenodd").attr("clip-rule", "evenodd").attr("d", "M24 4C35.0457 4 44 12.9543 44 24C44 35.0457 35.0457 44 24 44C12.9543 44 4 35.0457 4 24C4 12.9543 12.9543 4 24 4ZM42.0952 24C42.0952 14.0063 33.9937 5.90476 24 5.90476C14.0063 5.90476 5.90476 14.0063 5.90476 24C5.90476 33.9937 14.0063 42.0952 24 42.0952C33.9937 42.0952 42.0952 33.9937 42.0952 24Z").attr("fill", "#8B0E04"))); case "attention": return $("<span>").attr("id", "downArrow").append($("<svg>").attr("xmlns", "http://www.w3.org/2000/svg").attr("width", "16").attr("height", "16").attr("fill", "currentColor").attr("class", "bi bi-arrow-down arrow-back").attr("viewBox", "0 0 16 16").append($("<path>").attr("fill-rule", "evenodd").attr("d", "M8 1a.5.5 0 0 1 .5.5v11.793l3.146-3.147a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 .708-.708L7.5 13.293V1.5A.5.5 0 0 1 8 1z"))); case "resistance inducing": return $("<span>").attr("id", "updownArrow").append($("<svg>").attr("xmlns", "http://www.w3.org/2000/svg").attr("width", "16").attr("height", "16").attr("fill", "currentColor").attr("class", "bi bi-arrow-down-up arrow-back").attr("viewBox", "0 0 16 16").append($("<path>").attr("fill-rule", "evenodd").attr("d", "M11.5 15a.5.5 0 0 0 .5-.5V2.707l3.146 3.147a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 1 0 .708.708L11 2.707V14.5a.5.5 0 0 0 .5.5zm-7-14a.5.5 0 0 1 .5.5v11.793l3.146-3.147a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 .708-.708L4 13.293V1.5a.5.5 0 0 1 .5-.5z"))); case "<double-arrow>": return $("<span>").attr("id", "doubleArrow").append($("<svg>").attr("xmlns", "http://www.w3.org/2000/svg").attr("width", "16").attr("height", "16").attr("fill", "currentColor").attr("class", "bi bi-arrow-left-right arrow-back").attr("viewBox", "0 0 16 16").append($("<path>").attr("fill-rule", "evenodd").attr("d", "M1 11.5a.5.5 0 0 0 .5.5h11.793l-3.147 3.146a.5.5 0 0 0 .708.708l4-4a.5.5 0 0 0 0-.708l-4-4a.5.5 0 0 0-.708.708L13.293 11H1.5a.5.5 0 0 0-.5.5zm14-7a.5.5 0 0 1-.5.5H2.707l3.147 3.146a.5.5 0 1 1-.708.708l-4-4a.5.5 0 0 1 0-.708l4-4a.5.5 0 1 1 .708.708L2.707 4H14.5a.5.5 0 0 1 .5.5z"))) } } function getArrow(t) { switch (t) { case "<up>": return $("<span>").attr("id", "upArrow").append($("<svg>").attr("xmlns", "http://www.w3.org/2000/svg").attr("width", "16").attr("height", "16").attr("fill", "currentColor").attr("class", "bi bi-arrow-up arrow-back").attr("viewBox", "0 0 16 16").append($("<path>").attr("fill-rule", "evenodd").attr("d", "M8 15a.5.5 0 0 0 .5-.5V2.707l3.146 3.147a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 1 0 .708.708L7.5 2.707V14.5a.5.5 0 0 0 .5.5z"))); case "<down>": return $("<span>").attr("id", "downArrow").append($("<svg>").attr("xmlns", "http://www.w3.org/2000/svg").attr("width", "16").attr("height", "16").attr("fill", "currentColor").attr("class", "bi bi-arrow-down arrow-back").attr("viewBox", "0 0 16 16").append($("<path>").attr("fill-rule", "evenodd").attr("d", "M8 1a.5.5 0 0 1 .5.5v11.793l3.146-3.147a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 .708-.708L7.5 13.293V1.5A.5.5 0 0 1 8 1z"))); case "<up><down>": return $("<span>").attr("id", "updownArrow").append($("<svg>").attr("xmlns", "http://www.w3.org/2000/svg").attr("width", "16").attr("height", "16").attr("fill", "currentColor").attr("class", "bi bi-arrow-down-up arrow-back").attr("viewBox", "0 0 16 16").append($("<path>").attr("fill-rule", "evenodd").attr("d", "M11.5 15a.5.5 0 0 0 .5-.5V2.707l3.146 3.147a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 1 0 .708.708L11 2.707V14.5a.5.5 0 0 0 .5.5zm-7-14a.5.5 0 0 1 .5.5v11.793l3.146-3.147a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 .708-.708L4 13.293V1.5a.5.5 0 0 1 .5-.5z"))); case "<double-arrow>": return $("<span>").attr("id", "doubleArrow").append($("<svg>").attr("xmlns", "http://www.w3.org/2000/svg").attr("width", "16").attr("height", "16").attr("fill", "currentColor").attr("class", "bi bi-arrow-left-right arrow-back").attr("viewBox", "0 0 16 16").append($("<path>").attr("fill-rule", "evenodd").attr("d", "M1 11.5a.5.5 0 0 0 .5.5h11.793l-3.147 3.146a.5.5 0 0 0 .708.708l4-4a.5.5 0 0 0 0-.708l-4-4a.5.5 0 0 0-.708.708L13.293 11H1.5a.5.5 0 0 0-.5.5zm14-7a.5.5 0 0 1-.5.5H2.707l3.147 3.146a.5.5 0 1 1-.708.708l-4-4a.5.5 0 0 1 0-.708l4-4a.5.5 0 1 1 .708.708L2.707 4H14.5a.5.5 0 0 1 .5.5z"))) } } function createCardLayout(t) { return $col = $("<div>").attr("id", t + "cardCol").addClass("col").appendTo("#mainDeck"), $card = $("<div>").attr("id", t + "card").addClass("card h-100").appendTo($col), $("<div>").attr("id", t + "cardHead").addClass("card-header").appendTo($card), $("<div>").attr("id", t + "cardBody").addClass("card-body").append($("<div>").attr("id", t + "iconLayer").addClass("row").append($("<div>").addClass("col-6").attr("style", "text-align:center;").append($("<div>").attr("id", t + "vstackContra").addClass("vstack gap-2 mx-auto").append($("<h6>").text("Interaction"))), $("<div>").addClass("col-6").attr("style", "text-align:center;").append($("<div>").attr("id", t + "vstackEffect").addClass("vstack gap-2 mx-auto").append($("<h6>").text("Action")))), $("<div>").attr("id", t + "commentsLayer").addClass("row")).appendTo($card), $("<div>").attr("id", t + "cardFoot").addClass("card-footer").attr("style", "text-align:right;").appendTo($card), { colID: t + "cardCol", cardID: t + "card", headerID: t + "cardHead", bodyID: t + "cardBody", footerID: t + "cardFoot", vstackIntID: t + "vstackContra", vstackActionID: t + "vstackEffect", comments: t + "commentsLayer" } } function createCard(t) { if (checkDuplicatesOnCard(t.atc_level)) { var e = createCardLayout(t.atc_level); if ($("#" + e.headerID).append($("<h4>").text(t.generic_name)), $("#" + e.footerID).append($btnRemove = $("<a>").attr("id", t.atc_level + "btnRemove").addClass("btn medCardRemoveBtn").text("Remove")), "" != t.recode_effect_on_concentration_2) { const a = t.recode_effect_on_concentration_1.split("|"), r = t.recode_effect_on_concentration_2.split("|"); $("#" + e.vstackActionID).append($("<div>").addClass("row").append($("<div>").addClass("col-6").append(getArrow(a[0]), $("<p>").text(a[1])), $("<div>").addClass("col-6").append(getArrow(r[0]), $("<p>").text(r[1])))) } else { const a = t.recode_effect_on_concentration_1.split("|"); $("#" + e.vstackActionID).append(getArrow(a[0]), $("<p>").text(a[1])) } $("#" + e.comments).append($("<p>").text(t.clinical_comments)), selectedMedList.push(t.atc_level), selectedMedObjList.push(t), $btnRemove.on("click", function (a) { const r = selectedMedList.indexOf(t.atc_level); r > -1 && selectedMedList.splice(r, 1); selectedMedObjList.indexOf(t); r > -1 && selectedMedObjList.splice(r, 1), $("#" + e.colID).remove() }) } } function createGridRow(t) { if (checkDuplicates(t)) { if ($tableRow = $("<tr>").attr("id", "tr" + t.atc_level).appendTo($("#tbody")), $tableComments = $("<tr>").attr("id", "tr" + t.atc_level + "clinical_com").appendTo($("#tbody")), $("<th>").attr("scope", "row").text(t.generic_name).appendTo($tableRow), $btnRemove = $("<td>").addClass("close").attr("style", "padding:0.85rem;").appendTo($tableRow), $("<td>").text(t.recommendation).appendTo($tableRow), "" != t.recode_effect_on_concentration_2) { const r = t.recode_effect_on_concentration_1.split("|"), n = t.recode_effect_on_concentration_2.split("|"); var e = getArrow(r[0], r[1]), a = getArrow(n[0], n[1]); $("<td>").attr("style", "width:19rem;").append(e, a).appendTo($tableRow) } else { const e = t.recode_effect_on_concentration_1.split("|"); $("<td>").attr("style", "width:19rem;").append(getArrow(e[0], e[1])).appendTo($tableRow) } $("<th>").text("Clinical Comments").appendTo($tableComments), $("<td>").attr("colspan", "3").text(t.clinical_comments).appendTo($tableComments), selectedMedList.push(selectedMedDetails.atc_level), selectedMedObjList.push(selectedMedDetails), $btnRemove.on("click", function (e) { const a = selectedMedList.indexOf(t.atc_level); a > -1 && selectedMedList.splice(a, 1); selectedMedObjList.indexOf(t); a > -1 && selectedMedObjList.splice(a, 1), $("#tr" + t.atc_level).remove(), $("#tr" + t.atc_level + "clinical_com").remove() }) } } function addMed(t) { createCard(t) } function checkDuplicatesOnCard(t) { var e = !1; const a = $.map($("#mainDeck > .col"), t => t.id); if (0 == a.length) return e = !0; for (var r = 0; r < a.length; r++) { if (a[r] == t + "cardCol") return !1; e = !0 } return e } function checkDuplicates(t) { var e = !1, a = document.getElementById("medTable").getElementsByTagName("TR"); if (1 == a.length) return e = !0; for (var r = 0; r < a.length - 1; r++) { var n = a[r + 1].childNodes[0].innerHTML; if (t.generic_name == n) return !1; e = !0 } return e } function printPatHandOut() { var t = $("<html>"); $head = $("<head>").appendTo(t), $head.append($("<link>").attr("href", "https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css").attr("rel", "stylesheet").attr("integrity", "sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3").attr("crossorigin", "anonymous"), $("<script>").attr("src", "https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js")), $body = $("<body>").appendTo(t), $("<h1>").text("Patient Information Handout").appendTo($body), $("<p>").text("I have prescribed nirmatrelvir in comibination with ritonavir (Paxlovid) to treat your COVID infection").appendTo($body), $("<p>").text("The dosage is").appendTo($body), $("<p>").text("Some of your other medicines need adjustment while you are taking nirmatrelvir in combination with ritonavir (Paxlovid)").appendTo($body), $table = $("<table>").addClass("table table-bordered").appendTo($body), $tHead = $("<thead>").appendTo($table), $tHeaderRow = $("<tr>").appendTo($tHead), $("<th>").text("Medicine Name").attr("scope", "col").appendTo($tHeaderRow), $("<th>").text("Action to take while taking nirmatrelvir in combination with ritonavir (Paxlovid)").attr("scope", "col").appendTo($tHeaderRow), $tblBody = $("<tbody>").appendTo($table), $.each(selectedMedObjList, function (t, e) { $("<tr>").append($("<th>").text(e.generic_name), $("<td>").text(e.clinical_comments)).appendTo($tblBody) }); var e = window.open("", "Print-Window"); e.document.open(), e.document.write(t[0].outerHTML), setTimeout(function () { e.print() }, 5), e.document.close(), setTimeout(function () { e.close() }, 10) } function toggleSearchList() { document.getElementById("seacrchList").classList.toggle("show") } function filterFunction() { var t, e, a; for ($("#seacrchList").hasClass("show") || toggleSearchList(), t = document.getElementById("myInput").value.toUpperCase(), div = document.getElementById("seacrchList"), e = div.getElementsByTagName("a"), a = 0; a < e.length; a++)txtValue = e[a].textContent || e[a].innerText, txtValue.toUpperCase().indexOf(t) > -1 ? e[a].style.display = "" : e[a].style.display = "none" } $("#btnReset").on("click", function (t) { for (; selectedMedList.length;)selectedMedList.pop(); for (; selectedMedObjList.length;)selectedMedObjList.pop(); $("#tbody").remove(), $("<tbody>").attr("id", "tbody").appendTo($("#medTable")) }), $("#btnPrint").on("click", function (t) { printPatHandOut() }), $(document).ready(function () { var t = null; null != window.location.href.match(/[?]/g) && null == window.location.href.match(/[;]/g) && 1 == window.location.href.match(/[?]/g).length && "" != window.location.href.slice(window.location.href.indexOf("?") + 1) && (t = window.location.href.slice(window.location.href.indexOf("?") + 1).split("=")[1].split(",")), $cardDeck = $("<div>").attr("id", "mainDeck").addClass("row row-cols-1 row-cols-md-2 g-4").appendTo($("#divMedCon")), $.getJSON("fullATCTable.json", function (e) { $.each(e, function (e, a) { if (null != t) for (var r = 0; r < t.length; r++)t[r] == a.atc_level && addMed(a); a.generic_name != prevAddedItem && ($med = $("<a>").attr("id", a.atc_level).text(a.generic_name).appendTo("#seacrchList"), $med.on("click", function (t) { addMed(a) }), prevAddedItem = a.generic_name) }) }) });